{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    ":enablePreCommit",
    "github>mcsrobert/renovate-config"
  ],
  "flux": {
    "managerFilePatterns": [
      "/\\.ya?ml$/"
    ]
  },
  "helm-values": {
    "managerFilePatterns": [
      "/\\.ya?ml$/"
    ]
  },
  "customManagers": [
    {
      "description": ["Update YAML schema for HelmReleases with app-template chart"],
      "customType": "regex",
      "datasourceTemplate": "docker",
      "depNameTemplate": "ghcr.io/bjw-s-labs/helm/app-template",
      "managerFilePatterns": ["/(^|/)helm-?release.*\\.ya?ml$/"],
      "matchStrings": ["bjw-s-labs/helm-charts/app-template-(?<currentValue>\\d+\\.\\d+\\.\\d+)"],
      "versioningTemplate": "semver"
    },
    {
      "description": ["CloudnativePG Postgresql version"],
      "customType": "regex",
      "datasourceTemplate": "docker",
      "managerFilePatterns": ["/\\.yaml$/"],
      "matchStrings": ["imageName: (?<depName>\\S+):(?<currentValue>.*\\-.*)"],
      "versioningTemplate": "redhat"
    }
  ],
  "packageRules": [
    {
      "description": "Pin docker images from helm-values",
      "matchManagers": ["helm-values"],
      "matchDatasources": ["docker"],
      "pinDigests": true
    },
    {
      "groupName": "Flux",
      "matchDatasources": ["docker"],
      "group": {
        "commitMessageTopic": "{{{groupName}}} group"
      },
      "matchPackageNames": ["/flux-operator/", "/flux-instance/"]
    },
    {
      "groupName": "Immich",
      "matchDatasources": ["docker"],
      "matchPackageNames": ["/immich-/"],
      "group": {
        "commitMessageTopic": "{{{groupName}}} group"
      }
    },
    {
      "groupName": "Plugin Barman Cloud",
      "matchDatasources": ["docker", "helm"],
      "matchPackageNames": ["/plugin-barman-cloud/"],
      "group": {
        "commitMessageTopic": "{{{groupName}}} group"
      }
    }
  ]
}
